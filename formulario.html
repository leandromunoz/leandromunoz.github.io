<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Formulario de ingreso</title>
        <meta name="Ficha de inscripción" content="Rellena los datos para unirte al curso">
   
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script language="javascript"> 
        function mostrar()
            
        { 
            var num_user= 0;
            var reg_0= num_user + 1 ;
            var reg_1=document.getElementById("nombre"); 
            var reg_2=document.getElementById("apellido"); 
            var reg_3=document.getElementById("email");
            var reg_4=document.getElementById("edad"); 
            var x=document.getElementById("provincia");
            var reg_5=x.options[x.selectedIndex].value;
            var reg_6 = "no especifica"; 
            var inputElements = document.getElementsByClassName('info curso');
                for(var i=0; inputElements[i]; ++i){
                  if(inputElements[i].checked){
                       reg_6 = inputElements[i].value;
                       break;
                  }
                }
            
            var texto=document.getElementById("msg"); 
                if (texto.value ==""){
                    var reg_7 = "no coment";
                } else {
                    var reg_7= "coment";
                }
            
            var tabla=document.getElementById("table")
            
            if (reg_1.value==""||reg_2.value==""||reg_3.value==""||reg_4.value==""){
                alert("Debes completar todas las entradas con * ")
            }else if (reg_4.value<=15){
                alert ("Debes ser mayor de 16 años")
               }else{
            table.insertAdjacentHTML('beforeend', "<tr><td>"+reg_0+"</td><td>"+reg_1.value+"</td><td>"+reg_2.value+"</td><td>"+reg_3.value+"</td><td>"+reg_4.value+"</td><td>"+reg_5+"</td><td>"+reg_6+"</td><td>"+reg_7+"</td>"+'<td> <button type="button" id="borrar" class="btn btn-danger"onclick="borrar(this)" class="btn btn-danger">Quitar</button>');
                }
        } 

        function borrar(r) {
          var i = r.parentNode.parentNode.rowIndex;
          document.getElementById("tabla").deleteRow(i);
        }
       
            var tableToExcel = (function() {
     var uri = 'data:application/vnd.ms-excel;base64,',
       template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
       base64 = function(s) {
         return window.btoa(unescape(encodeURIComponent(s)))
       },
       format = function(s, c) {
         return s.replace(/{(\w+)}/g, function(m, p) {
           return c[p];
         })
       }
     return function(table, name) {
       if (!table.nodeType) table = document.getElementById(table)
       var ctx = {
         worksheet: name || 'Worksheet',
         table: table.innerHTML
       }
       window.location.href = uri + base64(format(template, ctx))
     }
   })()
    
        </script> 
    </head>
    <body>
        <div class="container">
        <form action="guardar_usuario.html" method="get">
            <div class="form-group">
            <h1>Formulario de ingreso</h1>
            
            <p>Rellena este formulario para completar tu solicitud de ingreso al curso</p>  
            
            <div>
                <label for="nombre">Nombre/s: <abbr title="required">*</abbr></label>
                <input type="text" name="nombre" size="40" id="nombre" required  maxlength="30" autofocus=""/>
            </div>
           
            <div>
                <label for="apellido">Apellido/s:  <abbr title="required">*</abbr></label>
                <input type="text" name="apellido" id="apellido" size="40" required  maxlength="30"/>
            </div>
          
            <div>
                <label for="email">E-mail: <abbr title="required">*</abbr></label>
                <input type="email" name="email" id="email" size="40" required/>
            </div>
               
            <div>
                <label for="edad">Edad: <abbr title="required">*</abbr></label>
                <input type="number" name="edad" id="edad" min="16" size="2" required/>    
            </div>
            
            <p>
              <label for="provincia">
                <span>Provincia de residencia:<abbr title="required">*</abbr></span>
              </label>
              <select id="provincia">
                  <option value="Buenos Aires">Bs. As.</option>
                  <option value="Catamarca">Catamarca</option>
                  <option value="Chaco">Chaco</option>
                  <option value="Chubut">Chubut</option>
                  <option value="Cordoba">Cordoba</option>
                  <option value="Corrientes">Corrientes</option>
                  <option value="Entre Rios">Entre Rios</option>
                  <option value="Formosa">Formosa</option>
                  <option value="Jujuy">Jujuy</option>
                  <option value="La Pampa">La Pampa</option>
                  <option value="La Rioja">La Rioja</option>
                  <option value="Mendoza" selected>Mendoza</option>
                  <option value="Misiones">Misiones</option>
                  <option value="Neuquen">Neuquen</option>
                  <option value="Rio Negro">Rio Negro</option>
                  <option value="Salta">Salta</option>
                  <option value="San Juan">San Juan</option>
                  <option value="San Luis">San Luis</option>
                  <option value="Santa Cruz">Santa Cruz</option>
                  <option value="Santa Fe">Santa Fe</option>
                  <option value="Sgo. del Estero">Sgo. del Estero</option>
                  <option value="Tierra del Fuego">Tierra del Fuego</option>
                  <option value="Tucuman">Tucuman</option>
              </select>
            </p>
            
           <fieldset id="info curso">
               <legend>¿Como te enteraste de este curso?</legend>
                <input type="checkbox" name="info curso" id="FB" class="info curso" value="FB" />
                <label for="FB">Facebook</label>
                <input type="checkbox" name="info curso" id="IG" class="info curso" value="IG" /> 
                <label for="IG">Instagram</label>
                <input type="checkbox" name="info curso" id="YT" class="info curso" value="YT" /> 
                <label for="YT">Youtube</label>
                <input type="checkbox" name="info curso" id="otro" class="info curso" value="otro" /> 
                <label for="otro">Otro</label>
            </fieldset>

            <div>
                <label for="msg" style="width: auto" >¿Que pretendes aprender?</label>
                <br>
                <textarea id="msg" name="mensaje" value=""></textarea>
                
            </div>
            
            
           
        </div>
        </form>
        
        <br>
        
         <div class="button">
                <button type="button" id="enviar" class="btn btn-succes" onclick="mostrar()" value="mostrar tabla">Ingresar datos</button>
               
            </div>
            
            <button type="button" class="btn btn-succes" onclick="tableToExcel('table', 'cualquiernombre')" value="Export to Excel">tabla excel </button>
<hr>

        <table id="table">
        <tr>

            <th >Nº Inscripto</th>

            <th>Nombre/s</th>

            <th>Apellido/s</th>

            <th>E-mail</th>
            
            <th>Edad</th>
            
            <th>Provincia</th>
                      
            <th>Info Curso</th>
            
            <th>Comentarios</th>

          </tr>

        
        </table>
        </div>    
        
    </body>
</html>
